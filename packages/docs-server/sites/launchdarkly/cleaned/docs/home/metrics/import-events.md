`/`
[Product docs](/docs/home)[Guides](/docs/guides)[SDKs](/docs/sdk)[Integrations](/docs/integrations)[API docs](/docs/api)[Tutorials](/docs/tutorials)[Flagship Blog](/docs/blog)
 * Getting started
 * [Overview](/docs/home)
 * [Launch Insights](/docs/home/getting-started/launch-insights)
 * [LaunchDarkly architecture](/docs/home/getting-started/architecture)
 * [LaunchDarkly vocabulary](/docs/home/getting-started/vocabulary)
 * Feature flags and AI Configs
 * [Create flags](/docs/home/flags/create)
 * [Target with flags](/docs/home/flags/target)
 * [Flag templates](/docs/home/flags/templates)
 * [Manage flags](/docs/home/flags/manage)
 * [Code references](/docs/home/flags/code-references)
 * [AI Configs](/docs/home/ai-configs)
 * [Contexts](/docs/home/flags/contexts)
 * [Segments](/docs/home/flags/segments)
 * Releases
 * [Releasing features with LaunchDarkly](/docs/home/releases/releasing)
 * [Release policies](/docs/home/releases/release-policies)
 * [Percentage rollouts](/docs/home/releases/percentage-rollouts)
 * [Progressive rollouts](/docs/home/releases/progressive-rollouts)
 * [Guarded rollouts](/docs/home/releases/guarded-rollouts)
 * [Feature monitoring](/docs/home/releases/feature-monitoring)
 * [Release pipelines](/docs/home/releases/release-pipelines)
 * [Engineering insights](/docs/home/releases/eng-insights)
 * [Release management tools](/docs/home/releases/release-management)
 * [Applications and app versions](/docs/home/releases/apps-and-app-versions)
 * [Change history](/docs/home/releases/change-history)
 * Observability
 * [Observability](/docs/home/observability)
 * [Session replay](/docs/home/observability/session-replay)
 * [Error monitoring](/docs/home/observability/errors)
 * [Logs](/docs/home/observability/logs)
 * [Traces](/docs/home/observability/traces)
 * [LLM observability](/docs/home/observability/llm-observability)
 * [Alerts](/docs/home/observability/alerts)
 * [Dashboards](/docs/home/observability/dashboards)
 * [Search specification](/docs/home/observability/search)
 * [Observability settings](/docs/home/observability/settings)
 * [Vega](/docs/home/observability/vega)
 * Product analytics
 * [Product analytics](/docs/home/product-analytics)
 * [Setting up product analytics](/docs/home/product-analytics/setup)
 * [Using product analytics charts](/docs/home/product-analytics/chart)
 * Experimentation
 * [Experimentation](/docs/home/experimentation)
 * [Creating experiments](/docs/home/experimentation/create)
 * [Managing experiments](/docs/home/experimentation/manage)
 * [Analyzing experiments](/docs/home/experimentation/analyze)
 * [Experimentation and metric events](/docs/home/experimentation/events)
 * [Multi-armed bandits](/docs/home/multi-armed-bandits)
 * [Holdouts](/docs/home/holdouts)
 * Metrics
 * [Metrics](/docs/home/metrics)
 * [Metric groups](/docs/home/metrics/metric-groups)
 * [Autogenerated metrics](/docs/home/metrics/autogen-metrics)
 * [Metric impact](/docs/home/metrics/metric-impact)
 * [Metric events](/docs/home/metrics/metric-events)
 * Warehouse native
 * [Warehouse native Experimentation](/docs/home/warehouse-native)
 * [Warehouse native metrics](/docs/home/warehouse-native/metrics)
 * [Creating warehouse native experiments](/docs/home/warehouse-native/creating)
 * Infrastructure
 * [Connect apps and services to LaunchDarkly](/docs/home/infrastructure/apps)
 * [LaunchDarkly in China and Pakistan](/docs/home/infrastructure/china)
 * [LaunchDarkly in the European Union (EU)](/docs/home/infrastructure/eu)
 * [LaunchDarkly in federal environments](/docs/home/infrastructure/federal)
 * [Public IP list](/docs/home/infrastructure/ip-list)
 * Your account
 * [Projects](/docs/home/account/project)
 * [Views](/docs/home/account/views)
 * [Environments](/docs/home/account/environment)
 * [Tags](/docs/home/account/tags)
 * [Teams](/docs/home/account/teams)
 * [Members](/docs/home/account/members)
 * [Roles](/docs/home/account/roles)
 * [Account security](/docs/home/account/secure)
 * [Billing and usage](/docs/home/account/billing)
 * [Changelog](/docs/home/changelog)
[Sign in](/)[Sign up](https://app.launchdarkly.com/signup)
On this page
 * [Overview](#overview)
 * [API details](#api-details)
 * [Client-side applications](#client-side-applications)
 * [Server-side applications](#server-side-applications)
 * [Request body format](#request-body-format)
 * [Examples](#examples)
 * [Responses and error handling](#responses-and-error-handling)
 * [Known limitations](#known-limitations)
 * [Best practices](#best-practices)
 * [Batch events](#batch-events)
 * [Retry failed requests](#retry-failed-requests)
 * [Billing implications](#billing-implications)
## Overview
This topic explains how to import metric events from your existing data pipeline for use with [Experimentation](/docs/home/experimentation) and [guarded rollouts](/docs/home/releases/guarded-rollouts). Using the metric import REST API described below, you can send your already-instrumented metrics into LaunchDarkly without writing and deploying new code for each metric.
Events are specific to one LaunchDarkly environment.
##### You may want to use a metric integration
If the metric events you want to use are already flowing through a tool such as Census, Sentry, Segment, Snowplow, or Tealium, consider using one of LaunchDarkly’s [Experimentation and metric integrations](/docs/integrations/experimentation).
## API details
You can import metric events from both client-side and server-side applications.
### Client-side applications
You can use this endpoint to send client-side custom events to LaunchDarkly when you cannot initialize the SDK. You can also use other tools, such as Shopify’s Liquid framework with Custom and Web Pixels, to subscribe and send events.
Here’s how to structure your import metric request for client-side applications:
Request element | Description 
---|--- 
Base URL | `https://events.launchdarkly.com[](https://events.launchdarkly.com/)` 
Resource | `/events/bulk/YOUR_CLIENT-SIDE_ID` 
The client-side event endpoint uses the client-side ID within the URL to identify the environment to submit events for. Replace `YOUR_CLIENT-SIDE_ID` with the client-side ID for your environment. You can find the client-side ID in the [environment menu](/docs/home/account/environment/keys#copy-sdk-credentials). 
REST method | `POST` 
Headers | 
 * `Content-Type: application/json`, required
 * `X-LaunchDarkly-Event-Schema: 4`, optional. Defaults to latest available version, but specifying this is recommended to avoid future breaking changes
Request body | The events to import, represented as a JSON array. For details on the format, read [Request body format](/docs/home/metrics/import-events#request-body-format), below. 
### Server-side applications
Here’s how to structure your import metric request for server-side applications:
Request element | Description 
---|--- 
Base URL | `https://events.launchdarkly.com[](https://events.launchdarkly.com/)` 
Resource | `/v2/event-data-import/YOUR_PROJECT_KEY/YOUR_ENVIRONMENT_KEY` 
Replace `YOUR_PROJECT_KEY` and `YOUR_ENVIRONMENT_KEY` with the project key and environment key, respectively, for the environment your metric events pertain to. To learn how to find these, read [Project keys](/docs/home/account/project#project-keys) and [Environment keys](/docs/home/account/environment/keys#environment-keys). 
REST method | `POST` 
Headers | 
 * `Authorization: YOUR_ACCESS_TOKEN`, required. This can be either a personal or service token. The access token must have a role that allows the `importEventData` action. We strongly recommend using a dedicated access token with this permission. To learn more, read [Environment actions](/docs/home/account/roles/role-actions#environment-actions).
 * `Content-Type: application/json`, required
 * `Content-Length: LENGTH_IN_BYTES`, required
 * `X-LaunchDarkly-Event-Schema: 4`, required
 * `X-LaunchDarkly-Payload-ID: YOUR_PAYLOAD_ID`, optional. Use this to send a UUID for the payload, which you can use to [retry failed requests](/docs/home/metrics/import-events#retry-failed-requests).
 * `User-Agent: MetricImport-YOUR_COMPANY_NAME-int/VERSION`, required. This helps us identify the source of traffic and debug issues. `VERSION` can be any format, but you should update it if you make major changes to your implementation.
 * `Content-Encoding: gzip`, optional. If you compress your request body, you must include this header.
Request body | The events to import, represented as a JSON array. For details on the format, read [Request body format](/docs/home/metrics/import-events#request-body-format), below. 
### Request body format
The request body must consist of a JSON array of `custom` events. Each event can include the following fields.
The `data` object is optional and can contain additional attributes such as error codes, request details, or other metadata.
Array of custom events
```
1
| [
---|--- 
2
| {
3
| "kind": "custom",
4
| "key": "example-event-key",
5
| "creationDate": 16420388151234,
6
| "metricValue": 32.0,
7
| "contextKeys": {
8
| "user": "context-key-123abc"
9
| },
10
| "data": {
11
| "error": "xyz",
12
| "screen": "checkout"
13
| }
14
| }
15
| // ... more events
16
| ]
```
Here are the details of each `custom` event field:
Custom event field | Description 
---|--- 
`kind` | The event kind. A string, must be set to `custom`. To learn about other event kinds, read [Event kinds](/docs/integrations/data-export/schema-reference#event-kinds). 
`key` | The event key identifies your metric event. When you create your metric in LaunchDarkly, its **Event key** must exactly match this value. The event key is different than the metric key. To learn more, read [Metrics](/docs/home/metrics). 
`creationDate` | Timestamp of when the event is created, in Unix milliseconds. 
`metricValue` | The numeric value of the metric. For numeric metrics, this is required. For conversion metrics, this is optional and LaunchDarkly ignores it if provided. 
`contextKeys` | A JSON object with one or more properties of the form `<contextKind>: <contextKey>`, listing the context keys for each context the metric event is associated with. For example, if your metric tracks user contexts, you might have `“user”: “user-key-123abc”`. 
Each context kind and key must exactly match those for the corresponding context provided to any LaunchDarkly SDKs evaluating flags that will be used with the metric. 
To learn more about using context kinds in experiments, read [Randomization units](/docs/home/experimentation/randomization). 
`data` | The `data` object is optional and can contain additional attributes such as error codes, request details, or other metadata. 
##### Event keys and metric keys are different
Sending custom events to LaunchDarkly requires a unique **event key**. You can set the event key to anything you want. Adding this event key to your codebase lets your SDK track actions customers take in your app as events. To learn more, read [Sending custom events](/docs/sdk/features/events).
LaunchDarkly also automatically generates a **metric key** when you create a metric. You only use the metric key to identify the metric in API calls. To learn more, read [Creating and managing metrics](/docs/home/metrics/create-metrics).
### Examples
Here is an example `curl` invocation for client-side applications that sends two metric events for different contexts to the same metric:
Example curl for client-side applications
```
$
| curl -i -X POST \
---|--- 
>
| -H 'Content-Type: application/json' \
>
| -H 'X-LaunchDarkly-Event-Schema: 4' \
>
| -d '[{"kind":"custom","contextKeys":{"user":"context-key-123abc"},"creationDate":1638561938594,"key":"example-metric-123abc","metricValue": 11.0},{"kind":"custom","contextKeys":{"user":"context-key-456def"},"creationDate":1638561938594,"key":"example-metric-456def","metricValue": 6.0}]' \
>
| https://events.launchdarkly.com/events/bulk/example-client-side-id
```
Here is an example `curl` invocation for server-side applications that sends two metric events for different contexts to the same metric:
Example curl for server-side applications
```
$
| curl -i -X POST \
---|--- 
>
| -H 'Authorization: YOUR_ACCESS_TOKEN' \
>
| -H 'Content-Type: application/json' \
>
| -H 'Content-Length: 282' \
>
| -H 'X-LaunchDarkly-Event-Schema: 4' \
>
| -H 'User-Agent: MetricImport-ACME-CORPORATION-int/1.0' \
>
| -d '[{"kind":"custom","contextKeys":{"user":"context-key-123abc"},"creationDate":1638561938594,"key":"example-metric-123abc","metricValue": 11.0},{"kind":"custom","contextKeys":{"user":"context-key-456def"},"creationDate":1638561938594,"key":"example-metric-456def","metricValue": 6.0}]' \
>
| https://events.launchdarkly.com/v2/event-data-import/example-project-key/example-environment-key
```
### Responses and error handling
Clients should expect to receive the following response status codes from the API:
Response status code | Description 
---|--- 
202 Accepted | The request completed successfully and the metric events were accepted for import. Events may still not be recorded if their format does not conform to the required JSON schema. To learn more, read [Known limitations](/docs/home/metrics/import-events#known-limitations). 
400 Invalid Request | No data in the payload was accepted 
401 Unauthorized | Your account does not have access to the metric import API, or your API access token does not have access to the `importEventData` action. 
406 Not Acceptable | The `X-LaunchDarkly-Event-Schema` header is not set to `4`. 
429 Too Many Requests | LaunchDarkly has recently received a very large volume of traffic from your account. 
5xx | The metric import API is temporarily unavailable. In this case the metric events may not have been accepted for import. 
4xx error responses have bodies in JSON format describing the reason for the error.
5xx error responses should be rare, and indicate the metrics may not have been accepted for import. To learn more, read [Retry failed requests](/docs/home/metrics/import-events#retry-failed-requests).
## Known limitations
There are a few known limitations with the metric import API. These include the following:
 * There is a limit on the request body size of 10MB per request. If you need to batch-upload a large number of historical events, please contact us for more information.
 * The API performs minimal validation on request bodies:
 * The API validates that the request is parsable JSON and that the event kind is `custom`. If this validation fails, the API returns a `400` error response.
 * The API does not validate other fields. If there are other fields within the event that do not conform to the required JSON schema, the event may be accepted for import, but then not processed. The API returns a `202` response in this situation.
 * If you are using the metric import API with Experimentation, the time at which LaunchDarkly receives an event at `events.launchdarkly.com` must be during an experiment’s running iteration, and must be after the time the contexts included in `contextKeys` first encountered the experiment. This means it is not possible to import events for an experiment iteration that you have already stopped.
## Best practices
We recommend the following best practices when importing metric events.
### Batch events
If possible, for efficiency, clients should send batches of events in each request, rather than making a separate request per event. For example, consider time-based batches sent once per minute. Clients are free to choose their own batch size, but the request body must be smaller than 10MB in total.
### Retry failed requests
Clients should not retry requests receiving 4xx responses, with the exception of 429 Too Many Requests.
429 and 5xx responses indicate transient issues, so it is appropriate to retry requests receiving these responses, in order to ensure that their events are accepted for import. Clients that retry requests must follow these instructions when doing so:
 * Clients must not retry immediately, but must back off, preferably with an exponentially increasing delay.
 * To ensure events are only processed once when retrying, all requests must include the `X-LaunchDarkly-Payload-ID` header. This header must contain a freshly generated payload id for each request. However, when retrying, the retries must _reuse the same payload id_ as the original request. LaunchDarkly uses this header to deduplicate repeated requests and ensure events are only processed once.
## Billing implications
There is no separate charge for importing metric events. However, if you use Data Export, imported events will be included in the data export, and will count toward Data Export usage. To learn more, read [Data Export](/docs/integrations/data-export).
[![Logo](https://files.buildwithfern.com/https://launchdarkly.docs.buildwithfern.com/docs/a8964c2c365fb94c416a0e31ff873d21ce0c3cbf40142e7e66cce5ae08a093af/assets/logo-dark.svg)![Logo](https://files.buildwithfern.com/https://launchdarkly.docs.buildwithfern.com/docs/a8964c2c365fb94c416a0e31ff873d21ce0c3cbf40142e7e66cce5ae08a093af/assets/logo-dark.svg)](/docs/home)
LaunchDarkly docs
LaunchDarkly docs
LaunchDarkly docs
LaunchDarkly docs