`/`
[Product docs](/docs/home)[Guides](/docs/guides)[SDKs](/docs/sdk)[Integrations](/docs/integrations)[API docs](/docs/api)[Tutorials](/docs/tutorials)[Flagship Blog](/docs/blog)
 * Getting started
 * [Overview](/docs/home)
 * [Launch Insights](/docs/home/getting-started/launch-insights)
 * [LaunchDarkly architecture](/docs/home/getting-started/architecture)
 * [LaunchDarkly vocabulary](/docs/home/getting-started/vocabulary)
 * Feature flags and AI Configs
 * [Create flags](/docs/home/flags/create)
 * [Target with flags](/docs/home/flags/target)
 * [Flag templates](/docs/home/flags/templates)
 * [Manage flags](/docs/home/flags/manage)
 * [Code references](/docs/home/flags/code-references)
 * [AI Configs](/docs/home/ai-configs)
 * [Contexts](/docs/home/flags/contexts)
 * [Segments](/docs/home/flags/segments)
 * Releases
 * [Releasing features with LaunchDarkly](/docs/home/releases/releasing)
 * [Release policies](/docs/home/releases/release-policies)
 * [Percentage rollouts](/docs/home/releases/percentage-rollouts)
 * [Progressive rollouts](/docs/home/releases/progressive-rollouts)
 * [Guarded rollouts](/docs/home/releases/guarded-rollouts)
 * [Feature monitoring](/docs/home/releases/feature-monitoring)
 * [Release pipelines](/docs/home/releases/release-pipelines)
 * [Engineering insights](/docs/home/releases/eng-insights)
 * [Release management tools](/docs/home/releases/release-management)
 * [Applications and app versions](/docs/home/releases/apps-and-app-versions)
 * [Change history](/docs/home/releases/change-history)
 * Observability
 * [Observability](/docs/home/observability)
 * [Session replay](/docs/home/observability/session-replay)
 * [Error monitoring](/docs/home/observability/errors)
 * [Logs](/docs/home/observability/logs)
 * [Traces](/docs/home/observability/traces)
 * [LLM observability](/docs/home/observability/llm-observability)
 * [Alerts](/docs/home/observability/alerts)
 * [Dashboards](/docs/home/observability/dashboards)
 * [Search specification](/docs/home/observability/search)
 * [Observability settings](/docs/home/observability/settings)
 * [Vega](/docs/home/observability/vega)
 * Product analytics
 * [Product analytics](/docs/home/product-analytics)
 * [Setting up product analytics](/docs/home/product-analytics/setup)
 * [Using product analytics charts](/docs/home/product-analytics/chart)
 * Experimentation
 * [Experimentation](/docs/home/experimentation)
 * [Creating experiments](/docs/home/experimentation/create)
 * [Managing experiments](/docs/home/experimentation/manage)
 * [Analyzing experiments](/docs/home/experimentation/analyze)
 * [Experimentation and metric events](/docs/home/experimentation/events)
 * [Multi-armed bandits](/docs/home/multi-armed-bandits)
 * [Holdouts](/docs/home/holdouts)
 * Metrics
 * [Metrics](/docs/home/metrics)
 * [Metric groups](/docs/home/metrics/metric-groups)
 * [Autogenerated metrics](/docs/home/metrics/autogen-metrics)
 * [Metric impact](/docs/home/metrics/metric-impact)
 * [Metric events](/docs/home/metrics/metric-events)
 * Warehouse native
 * [Warehouse native Experimentation](/docs/home/warehouse-native)
 * [Warehouse native metrics](/docs/home/warehouse-native/metrics)
 * [Creating warehouse native experiments](/docs/home/warehouse-native/creating)
 * Infrastructure
 * [Connect apps and services to LaunchDarkly](/docs/home/infrastructure/apps)
 * [LaunchDarkly in China and Pakistan](/docs/home/infrastructure/china)
 * [LaunchDarkly in the European Union (EU)](/docs/home/infrastructure/eu)
 * [LaunchDarkly in federal environments](/docs/home/infrastructure/federal)
 * [Public IP list](/docs/home/infrastructure/ip-list)
 * Your account
 * [Projects](/docs/home/account/project)
 * [Views](/docs/home/account/views)
 * [Environments](/docs/home/account/environment)
 * [Tags](/docs/home/account/tags)
 * [Teams](/docs/home/account/teams)
 * [Members](/docs/home/account/members)
 * [Roles](/docs/home/account/roles)
 * [Account security](/docs/home/account/secure)
 * [Billing and usage](/docs/home/account/billing)
 * [Changelog](/docs/home/changelog)
[Sign in](/)[Sign up](https://app.launchdarkly.com/signup)
On this page
 * [Overview](#overview)
 * [Roll out by context attribute](#roll-out-by-context-attribute)
 * [Target and roll out by different context attributes](#target-and-roll-out-by-different-context-attributes)
 * [Maintaining customer experience across anonymous and logged-in states](#maintaining-customer-experience-across-anonymous-and-logged-in-states)
 * [Single contexts](#single-contexts)
 * [Multi-contexts](#multi-contexts)
## Overview
This topic explains how to perform percentage rollouts by associating flag variations with context attributes, whether the user context is in an anonymous or logged-in state.
## Roll out by context attribute
You can assign variations to contexts through a percentage rollout based on any attribute in the “Context kind” and “Attribute” menus.
For example, when you roll out a feature to 25% of user contexts, you can specify that each end user be assigned to a variation based on the value of the “country” attribute in their user context, rather than being assigned to a variation based on their context key. This ensures that LaunchDarkly assigns all customers with matching attribute-value pairs to the same variation. To learn more about attributes, read [Context attributes](/docs/home/flags/context-attributes).
In this example, the feature will be rolled out to a percentage of users whose organization is in Canada.
Here is an image of a rollout by the “country” attribute for a user context:
![A percentage rollout by the "country" attribute for a user context.](https://files.buildwithfern.com/https://launchdarkly.docs.buildwithfern.com/docs/3c6bd451cd97e428f7c0530daf6494d21a5ebe7cdfa9059c8464ffade1214e18/assets/images/auto/rules-percentage-rollout-attribute.auto.png)
A percentage rollout by the "country" attribute for a user context.
The attribute must have either string values or integer numeric values. If you use an attribute with a numeric value that includes a fraction, or has a value type besides `string` or `number`, then the SDK cannot use the attribute value and assigns the context to an arbitrary variation.
### Target and roll out by different context attributes
When you use a percentage rollout on a flag’s targeting rule, you can target on one context kind, but roll out the feature based on a different context kind. We only recommend doing this if you are using [multi-contexts](/docs/home/flags/multi-contexts). For example, if your app is evaluating all flags using a multi-context that includes both `user` and `organization` context kinds, you might target by an `organization` attribute but roll out the feature based on a `user` attribute.
In this example, the feature will be rolled out to a percentage of users whose organization is in Canada.
Here is an image of a rule targeting the “country” attribute for an organization context, rolling out by user:
![A flag targeting rule that targets on an organization attribute and uses a percentage rollout on a user attribute.](https://files.buildwithfern.com/https://launchdarkly.docs.buildwithfern.com/docs/758ede4972b0dac07f4fdc529299c578798324b2a1ab18f4261cceef38812db7/assets/images/auto/flag-rules-target-and-percentage-diff-context-kinds.auto.png)
A flag targeting rule that targets on an organization attribute and uses a percentage rollout on a user attribute.
##### Other context kinds may not receive the default variation
Use caution with this approach, as it may have unintended consequences if not all of the contexts that encounter this flag are multi-contexts containing both context kinds.
If a context matches the targeting rule that uses a percentage rollout, but its context kind is not the one by which the rollout occurs, then LaunchDarkly serves the first variation listed in the percentage rollout configuration with a percentage greater than zero. This may not be the default variation. To learn more, read [Percentage rollout logic](/docs/home/releases/percentage-rollouts#percentage-rollout-logic).
## Maintaining customer experience across anonymous and logged-in states
Contexts are designed to let you target different types of entities, such as devices and organizations, precisely. However, if your application requires a user login, you will probably use a “user” context, at least for some of the attributes you are storing. When your application has both anonymous and logged-in states, you want to maintain the customer experience across both states.
There are two approaches to maintaining the customer experience across pre-login (anonymous end user) and post-login (known end user) states: single contexts and multi-contexts.
### Single contexts
The first approach uses single contexts. You can set an attribute in a user context and set your percentage rollouts to roll out based on that attribute.
Here’s how to do this:
 1. Store a unique identifier for the anonymous end user. A session ID or UUID works well.
 * You can store this identifier in local storage or a cookie.
 * If you are using a mobile SDK, the SDK can generate the unique identifier for you and use it as the context key.
![](https://fern-image-hosting.s3.us-east-1.amazonaws.com/launchdarkly/terminal.svg)
Configure your SDK: [Anonymous contexts in client-side SDKs](/docs/sdk/features/anonymous#client-side-sdks)
 1. Use this unique identifier as both the context’s key and an attribute in the user context until the end user logs in. The attribute can be named anything, for example, `uniqueId`.
 2. While the end user is logged in, set the context’s key to their real (primary) context key, but continue to use the stored unique identifier as the context’s `uniqueId` attribute.
 3. For all flags, or for those that may affect logged out users, set your flags to serve percentage rollouts based on the `uniqueId` attribute.
To learn more about anonymous contexts, read [Anonymous contexts](/docs/home/flags/anonymous-contexts).
One disadvantage to this approach is that using a `uniqueId` attribute, rather than context key, means that you cannot easily convert the rollout strategy from percentage rollout to experiment. To learn more, read [Allocate audiences](/docs/home/experimentation/allocation#allocate-audiences).
### Multi-contexts
The second approach uses multi-contexts. You can use an attribute, such as the context key, in a non-user context and set flags’ percentage rollouts based on that attribute.
Here’s how to do this:
 1. Store a unique identifier for the anonymous end user as the context key in a different kind of context, such as a device context. A device ID or UUID works well.
 2. Target the end user based on this context key while they are not yet logged in.
 3. After the end user logs in, store their user information in a user context. Associate the device context and the user context with each other. To do this, identify a multi-context that includes both individual contexts when you want the association to occur.
 4. For all flags, or for those that may affect logged out users, set your flags to serve percentage rollouts based on the unique identifier in the device context.
To learn more, read [Multi-contexts](/docs/home/flags/multi-contexts).
![](https://fern-image-hosting.s3.us-east-1.amazonaws.com/launchdarkly/terminal.svg)
Try it in your SDK: [Identifying and changing contexts](/docs/sdk/features/identify)
[![Logo](https://files.buildwithfern.com/https://launchdarkly.docs.buildwithfern.com/docs/a8964c2c365fb94c416a0e31ff873d21ce0c3cbf40142e7e66cce5ae08a093af/assets/logo-dark.svg)![Logo](https://files.buildwithfern.com/https://launchdarkly.docs.buildwithfern.com/docs/a8964c2c365fb94c416a0e31ff873d21ce0c3cbf40142e7e66cce5ae08a093af/assets/logo-dark.svg)](/docs/home)
LaunchDarkly docs
LaunchDarkly docs
LaunchDarkly docs
LaunchDarkly docs