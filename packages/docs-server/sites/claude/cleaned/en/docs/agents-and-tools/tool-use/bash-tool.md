Agent Skills are now available! [Learn more about extending Claude's capabilities with Agent Skills](/en/docs/agents-and-tools/agent-skills/overview).
[Claude Docs home page![light logo](https://mintcdn.com/anthropic-claude-docs/DcI2Ybid7ZEnFaf0/logo/light.svg?fit=max&auto=format&n=DcI2Ybid7ZEnFaf0&q=85&s=c877c45432515ee69194cb19e9f983a2)![dark logo](https://mintcdn.com/anthropic-claude-docs/DcI2Ybid7ZEnFaf0/logo/dark.svg?fit=max&auto=format&n=DcI2Ybid7ZEnFaf0&q=85&s=f5bb877be0cb3cba86cf6d7c88185216)](/)
![US](https://d3gk2c5xim1je2.cloudfront.net/flags/US.svg)
English
Search...
⌘K
Search...
Navigation
Tools
Bash tool
[Welcome](/en/home)[Claude Developer Platform](/en/docs/intro)[Claude Code](/en/docs/claude-code/overview)[Model Context Protocol (MCP)](/en/docs/mcp)[API Reference](/en/api/messages)[Resources](/en/resources/overview)[Release Notes](/en/release-notes/overview)
* [](/en/docs/intro)
* [](/en/api/overview)
##### First steps
 * [Intro to Claude](/en/docs/intro)
 * [Quick start](/en/docs/get-started)
##### Models & pricing
 * [Models overview](/en/docs/about-claude/models/overview)
 * [Choosing a model](/en/docs/about-claude/models/choosing-a-model)
 * [What's new in Claude 4.5](/en/docs/about-claude/models/whats-new-claude-4-5)
 * [Migrating to Claude 4.5](/en/docs/about-claude/models/migrating-to-claude-4)
 * [Model deprecations](/en/docs/about-claude/model-deprecations)
 * [Pricing](/en/docs/about-claude/pricing)
##### Learn about Claude
 * [Features overview](/en/docs/build-with-claude/overview)
 * [Building with Claude](/en/docs/overview)
 * [Context windows](/en/docs/build-with-claude/context-windows)
 * [Glossary](/en/docs/about-claude/glossary)
##### Capabilities
 * [Prompt caching](/en/docs/build-with-claude/prompt-caching)
 * [Context editing](/en/docs/build-with-claude/context-editing)
 * [Extended thinking](/en/docs/build-with-claude/extended-thinking)
 * [Streaming Messages](/en/docs/build-with-claude/streaming)
 * [Batch processing](/en/docs/build-with-claude/batch-processing)
 * [Citations](/en/docs/build-with-claude/citations)
 * [Multilingual support](/en/docs/build-with-claude/multilingual-support)
 * [Token counting](/en/docs/build-with-claude/token-counting)
 * [Embeddings](/en/docs/build-with-claude/embeddings)
 * [Vision](/en/docs/build-with-claude/vision)
 * [PDF support](/en/docs/build-with-claude/pdf-support)
 * [Files API](/en/docs/build-with-claude/files)
 * [Search results](/en/docs/build-with-claude/search-results)
 * [Google Sheets add-on](/en/docs/agents-and-tools/claude-for-sheets)
##### Tools
 * [Overview](/en/docs/agents-and-tools/tool-use/overview)
 * [How to implement tool use](/en/docs/agents-and-tools/tool-use/implement-tool-use)
 * [Token-efficient tool use](/en/docs/agents-and-tools/tool-use/token-efficient-tool-use)
 * [Fine-grained tool streaming](/en/docs/agents-and-tools/tool-use/fine-grained-tool-streaming)
 * [Bash tool](/en/docs/agents-and-tools/tool-use/bash-tool)
 * [Code execution tool](/en/docs/agents-and-tools/tool-use/code-execution-tool)
 * [Computer use tool](/en/docs/agents-and-tools/tool-use/computer-use-tool)
 * [Text editor tool](/en/docs/agents-and-tools/tool-use/text-editor-tool)
 * [Web fetch tool](/en/docs/agents-and-tools/tool-use/web-fetch-tool)
 * [Web search tool](/en/docs/agents-and-tools/tool-use/web-search-tool)
 * [Memory tool](/en/docs/agents-and-tools/tool-use/memory-tool)
##### Agent Skills
 * [Overview](/en/docs/agents-and-tools/agent-skills/overview)
 * [Quickstart](/en/docs/agents-and-tools/agent-skills/quickstart)
 * [Best practices](/en/docs/agents-and-tools/agent-skills/best-practices)
##### Model Context Protocol (MCP)
 * [MCP connector](/en/docs/agents-and-tools/mcp-connector)
 * [Remote MCP servers](/en/docs/agents-and-tools/remote-mcp-servers)
##### Use cases
 * [Overview](/en/docs/about-claude/use-case-guides/overview)
 * [Ticket routing](/en/docs/about-claude/use-case-guides/ticket-routing)
 * [Customer support agent](/en/docs/about-claude/use-case-guides/customer-support-chat)
 * [Content moderation](/en/docs/about-claude/use-case-guides/content-moderation)
 * [Legal summarization](/en/docs/about-claude/use-case-guides/legal-summarization)
##### Prompt engineering
 * [Overview](/en/docs/build-with-claude/prompt-engineering/overview)
 * [Claude 4 best practices](/en/docs/build-with-claude/prompt-engineering/claude-4-best-practices)
 * [Prompt generator](/en/docs/build-with-claude/prompt-engineering/prompt-generator)
 * [Use prompt templates](/en/docs/build-with-claude/prompt-engineering/prompt-templates-and-variables)
 * [Prompt improver](/en/docs/build-with-claude/prompt-engineering/prompt-improver)
 * [Be clear and direct](/en/docs/build-with-claude/prompt-engineering/be-clear-and-direct)
 * [Use examples (multishot prompting)](/en/docs/build-with-claude/prompt-engineering/multishot-prompting)
 * [Let Claude think (CoT)](/en/docs/build-with-claude/prompt-engineering/chain-of-thought)
 * [Use XML tags](/en/docs/build-with-claude/prompt-engineering/use-xml-tags)
 * [Give Claude a role (system prompts)](/en/docs/build-with-claude/prompt-engineering/system-prompts)
 * [Prefill Claude's response](/en/docs/build-with-claude/prompt-engineering/prefill-claudes-response)
 * [Chain complex prompts](/en/docs/build-with-claude/prompt-engineering/chain-prompts)
 * [Long context tips](/en/docs/build-with-claude/prompt-engineering/long-context-tips)
 * [Extended thinking tips](/en/docs/build-with-claude/prompt-engineering/extended-thinking-tips)
##### Test & evaluate
 * [Define success criteria](/en/docs/test-and-evaluate/define-success)
 * [Develop test cases](/en/docs/test-and-evaluate/develop-tests)
 * [Using the Evaluation Tool](/en/docs/test-and-evaluate/eval-tool)
 * [Reducing latency](/en/docs/test-and-evaluate/strengthen-guardrails/reduce-latency)
##### Strengthen guardrails
 * [Reduce hallucinations](/en/docs/test-and-evaluate/strengthen-guardrails/reduce-hallucinations)
 * [Increase output consistency](/en/docs/test-and-evaluate/strengthen-guardrails/increase-consistency)
 * [Mitigate jailbreaks](/en/docs/test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks)
 * [Streaming refusals](/en/docs/test-and-evaluate/strengthen-guardrails/handle-streaming-refusals)
 * [Reduce prompt leak](/en/docs/test-and-evaluate/strengthen-guardrails/reduce-prompt-leak)
 * [Keep Claude in character](/en/docs/test-and-evaluate/strengthen-guardrails/keep-claude-in-character)
On this page
 * [Overview](#overview)
 * [Model compatibility](#model-compatibility)
 * [Use cases](#use-cases)
 * [Quick start](#quick-start)
 * [How it works](#how-it-works)
 * [Parameters](#parameters)
 * [Example: Multi-step automation](#example%3A-multi-step-automation)
 * [Implement the bash tool](#implement-the-bash-tool)
 * [Handle errors](#handle-errors)
 * [Follow implementation best practices](#follow-implementation-best-practices)
 * [Security](#security)
 * [Key recommendations](#key-recommendations)
 * [Pricing](#pricing)
 * [Common patterns](#common-patterns)
 * [Development workflows](#development-workflows)
 * [File operations](#file-operations)
 * [System tasks](#system-tasks)
 * [Limitations](#limitations)
 * [Combining with other tools](#combining-with-other-tools)
 * [Next steps](#next-steps)
The bash tool enables Claude to execute shell commands in a persistent bash session, allowing system operations, script execution, and command-line automation.
## 
[​](#overview)
Overview
The bash tool provides Claude with:
 * Persistent bash session that maintains state
 * Ability to run any shell command
 * Access to environment variables and working directory
 * Command chaining and scripting capabilities
## 
[​](#model-compatibility)
Model compatibility
Model | Tool Version 
---|--- 
Claude 4 models and Sonnet 3.7 | `bash_20250124` 
Claude Sonnet 3.5 ([deprecated](/en/docs/about-claude/model-deprecations)) | `bash_20241022` 
Claude Sonnet 3.5 ([deprecated](/en/docs/about-claude/model-deprecations)) requires the `computer-use-2024-10-22` beta header when using the bash tool.The bash tool is generally available in Claude 4 models and Sonnet 3.7.
Older tool versions are not guaranteed to be backwards-compatible with newer models. Always use the tool version that corresponds to your model version.
## 
[​](#use-cases)
Use cases
 * **Development workflows** : Run build commands, tests, and development tools
 * **System automation** : Execute scripts, manage files, automate tasks
 * **Data processing** : Process files, run analysis scripts, manage datasets
 * **Environment setup** : Install packages, configure environments
## 
[​](#quick-start)
Quick start
Python
Shell
Copy
```
import anthropic
client = anthropic.Anthropic()
response = client.messages.create(
 model="claude-sonnet-4-5",
 max_tokens=1024,
 tools=[
 {
 "type": "bash_20250124",
 "name": "bash"
 }
 ],
 messages=[
 {"role": "user", "content": "List all Python files in the current directory."}
 ]
)
```
## 
[​](#how-it-works)
How it works
The bash tool maintains a persistent session:
 1. Claude determines what command to run
 2. You execute the command in a bash shell
 3. Return the output (stdout and stderr) to Claude
 4. Session state persists between commands (environment variables, working directory)
## 
[​](#parameters)
Parameters
Parameter | Required | Description 
---|---|--- 
`command` | Yes* | The bash command to run 
`restart` | No | Set to `true` to restart the bash session 
*Required unless using `restart`
Example usage
Copy
```
// Run a command
{
 "command": "ls -la *.py"
}
// Restart the session
{
 "restart": true
}
```
## 
[​](#example%3A-multi-step-automation)
Example: Multi-step automation
Claude can chain commands to complete complex tasks:
Copy
```
# User request
"Install the requests library and create a simple Python script that fetches a joke from an API, then run it."
# Claude's tool uses:
# 1. Install package
{"command": "pip install requests"}
# 2. Create script
{"command": "cat > fetch_joke.py << 'EOF'\nimport requests\nresponse = requests.get('https://official-joke-api.appspot.com/random_joke')\njoke = response.json()\nprint(f\"Setup: {joke['setup']}\")\nprint(f\"Punchline: {joke['punchline']}\")\nEOF"}
# 3. Run script
{"command": "python fetch_joke.py"}
```
The session maintains state between commands, so files created in step 2 are available in step 3.
* * *
## 
[​](#implement-the-bash-tool)
Implement the bash tool
The bash tool is implemented as a schema-less tool. When using this tool, you don’t need to provide an input schema as with other tools; the schema is built into Claude’s model and can’t be modified.
1
Set up a bash environment
Create a persistent bash session that Claude can interact with:
Copy
```
import subprocess
import threading
import queue
class BashSession:
 def __init__(self):
 self.process = subprocess.Popen(
 ['/bin/bash'],
 stdin=subprocess.PIPE,
 stdout=subprocess.PIPE,
 stderr=subprocess.PIPE,
 text=True,
 bufsize=0
 )
 self.output_queue = queue.Queue()
 self.error_queue = queue.Queue()
 self._start_readers()
```
2
Handle command execution
Create a function to execute commands and capture output:
Copy
```
def execute_command(self, command):
 # Send command to bash
 self.process.stdin.write(command + '\n')
 self.process.stdin.flush()
 # Capture output with timeout
 output = self._read_output(timeout=10)
 return output
```
3
Process Claude's tool calls
Extract and execute commands from Claude’s responses:
Copy
```
for content in response.content:
 if content.type == "tool_use" and content.name == "bash":
 if content.input.get("restart"):
 bash_session.restart()
 result = "Bash session restarted"
 else:
 command = content.input.get("command")
 result = bash_session.execute_command(command)
 # Return result to Claude
 tool_result = {
 "type": "tool_result",
 "tool_use_id": content.id,
 "content": result
 }
```
4
Implement safety measures
Add validation and restrictions:
Copy
```
def validate_command(command):
 # Block dangerous commands
 dangerous_patterns = ['rm -rf /', 'format', ':(){:|:&};:']
 for pattern in dangerous_patterns:
 if pattern in command:
 return False, f"Command contains dangerous pattern: {pattern}"
 # Add more validation as needed
 return True, None
```
### 
[​](#handle-errors)
Handle errors
When implementing the bash tool, handle various error scenarios:
Command execution timeout
If a command takes too long to execute:
Copy
```
{
 "role": "user",
 "content": [
 {
 "type": "tool_result",
 "tool_use_id": "toolu_01A09q90qw90lq917835lq9",
 "content": "Error: Command timed out after 30 seconds",
 "is_error": true
 }
 ]
}
```
Command not found
If a command doesn’t exist:
Copy
```
{
 "role": "user",
 "content": [
 {
 "type": "tool_result",
 "tool_use_id": "toolu_01A09q90qw90lq917835lq9",
 "content": "bash: nonexistentcommand: command not found",
 "is_error": true
 }
 ]
}
```
Permission denied
If there are permission issues:
Copy
```
{
 "role": "user",
 "content": [
 {
 "type": "tool_result",
 "tool_use_id": "toolu_01A09q90qw90lq917835lq9",
 "content": "bash: /root/sensitive-file: Permission denied",
 "is_error": true
 }
 ]
}
```
### 
[​](#follow-implementation-best-practices)
Follow implementation best practices
Use command timeouts
Implement timeouts to prevent hanging commands:
Copy
```
def execute_with_timeout(command, timeout=30):
 try:
 result = subprocess.run(
 command, 
 shell=True, 
 capture_output=True, 
 text=True, 
 timeout=timeout
 )
 return result.stdout + result.stderr
 except subprocess.TimeoutExpired:
 return f"Command timed out after {timeout} seconds"
```
Maintain session state
Keep the bash session persistent to maintain environment variables and working directory:
Copy
```
# Commands run in the same session maintain state
commands = [
 "cd /tmp",
 "echo 'Hello' > test.txt",
 "cat test.txt" # This works because we're still in /tmp
]
```
Handle large outputs
Truncate very large outputs to prevent token limit issues:
Copy
```
def truncate_output(output, max_lines=100):
 lines = output.split('\n')
 if len(lines) > max_lines:
 truncated = '\n'.join(lines[:max_lines])
 return f"{truncated}\n\n... Output truncated ({len(lines)} total lines) ..."
 return output
```
Log all commands
Keep an audit trail of executed commands:
Copy
```
import logging
def log_command(command, output, user_id):
 logging.info(f"User {user_id} executed: {command}")
 logging.info(f"Output: {output[:200]}...") # Log first 200 chars
```
Sanitize outputs
Remove sensitive information from command outputs:
Copy
```
def sanitize_output(output):
 # Remove potential secrets or credentials
 import re
 # Example: Remove AWS credentials
 output = re.sub(r'aws_access_key_id\s*=\s*\S+', 'aws_access_key_id=***', output)
 output = re.sub(r'aws_secret_access_key\s*=\s*\S+', 'aws_secret_access_key=***', output)
 return output
```
## 
[​](#security)
Security
The bash tool provides direct system access. Implement these essential safety measures:
 * Running in isolated environments (Docker/VM)
 * Implementing command filtering and allowlists
 * Setting resource limits (CPU, memory, disk)
 * Logging all executed commands
### 
[​](#key-recommendations)
Key recommendations
 * Use `ulimit` to set resource constraints
 * Filter dangerous commands (`sudo`, `rm -rf`, etc.)
 * Run with minimal user permissions
 * Monitor and log all command execution
## 
[​](#pricing)
Pricing
The bash tool adds **245 input tokens** to your API calls. Additional tokens are consumed by:
 * Command outputs (stdout/stderr)
 * Error messages
 * Large file contents
See [tool use pricing](/en/docs/agents-and-tools/tool-use/overview#pricing) for complete pricing details.
## 
[​](#common-patterns)
Common patterns
### 
[​](#development-workflows)
Development workflows
 * Running tests: `pytest && coverage report`
 * Building projects: `npm install && npm run build`
 * Git operations: `git status && git add . && git commit -m "message"`
### 
[​](#file-operations)
File operations
 * Processing data: `wc -l *.csv && ls -lh *.csv`
 * Searching files: `find . -name "*.py" | xargs grep "pattern"`
 * Creating backups: `tar -czf backup.tar.gz ./data`
### 
[​](#system-tasks)
System tasks
 * Checking resources: `df -h && free -m`
 * Process management: `ps aux | grep python`
 * Environment setup: `export PATH=$PATH:/new/path && echo $PATH`
## 
[​](#limitations)
Limitations
 * **No interactive commands** : Cannot handle `vim`, `less`, or password prompts
 * **No GUI applications** : Command-line only
 * **Session scope** : Persists within conversation, lost between API calls
 * **Output limits** : Large outputs may be truncated
 * **No streaming** : Results returned after completion
## 
[​](#combining-with-other-tools)
Combining with other tools
The bash tool is most powerful when combined with the [text editor](/en/docs/agents-and-tools/tool-use/text-editor-tool) and other tools.
## 
[​](#next-steps)
Next steps
## [Tool use overview Learn about tool use with Claude ](/en/docs/agents-and-tools/tool-use/overview)## [Text editor tool View and edit text files with Claude ](/en/docs/agents-and-tools/tool-use/text-editor-tool)
Was this page helpful?
YesNo
[Fine-grained tool streaming](/en/docs/agents-and-tools/tool-use/fine-grained-tool-streaming)[Code execution tool](/en/docs/agents-and-tools/tool-use/code-execution-tool)
Assistant
Responses are generated using AI and may contain mistakes.