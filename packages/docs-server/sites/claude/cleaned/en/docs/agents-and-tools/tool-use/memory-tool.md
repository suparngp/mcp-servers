Agent Skills are now available! [Learn more about extending Claude's capabilities with Agent Skills](/en/docs/agents-and-tools/agent-skills/overview).
[Claude Docs home page![light logo](https://mintcdn.com/anthropic-claude-docs/DcI2Ybid7ZEnFaf0/logo/light.svg?fit=max&auto=format&n=DcI2Ybid7ZEnFaf0&q=85&s=c877c45432515ee69194cb19e9f983a2)![dark logo](https://mintcdn.com/anthropic-claude-docs/DcI2Ybid7ZEnFaf0/logo/dark.svg?fit=max&auto=format&n=DcI2Ybid7ZEnFaf0&q=85&s=f5bb877be0cb3cba86cf6d7c88185216)](/)
![US](https://d3gk2c5xim1je2.cloudfront.net/flags/US.svg)
English
Search...
⌘K
Search...
Navigation
Tools
Memory tool
[Welcome](/en/home)[Claude Developer Platform](/en/docs/intro)[Claude Code](/en/docs/claude-code/overview)[Model Context Protocol (MCP)](/en/docs/mcp)[API Reference](/en/api/messages)[Resources](/en/resources/overview)[Release Notes](/en/release-notes/overview)
* [](/en/docs/intro)
* [](/en/api/overview)
##### First steps
 * [Intro to Claude](/en/docs/intro)
 * [Quick start](/en/docs/get-started)
##### Models & pricing
 * [Models overview](/en/docs/about-claude/models/overview)
 * [Choosing a model](/en/docs/about-claude/models/choosing-a-model)
 * [What's new in Claude 4.5](/en/docs/about-claude/models/whats-new-claude-4-5)
 * [Migrating to Claude 4.5](/en/docs/about-claude/models/migrating-to-claude-4)
 * [Model deprecations](/en/docs/about-claude/model-deprecations)
 * [Pricing](/en/docs/about-claude/pricing)
##### Learn about Claude
 * [Features overview](/en/docs/build-with-claude/overview)
 * [Building with Claude](/en/docs/overview)
 * [Context windows](/en/docs/build-with-claude/context-windows)
 * [Glossary](/en/docs/about-claude/glossary)
##### Capabilities
 * [Prompt caching](/en/docs/build-with-claude/prompt-caching)
 * [Context editing](/en/docs/build-with-claude/context-editing)
 * [Extended thinking](/en/docs/build-with-claude/extended-thinking)
 * [Streaming Messages](/en/docs/build-with-claude/streaming)
 * [Batch processing](/en/docs/build-with-claude/batch-processing)
 * [Citations](/en/docs/build-with-claude/citations)
 * [Multilingual support](/en/docs/build-with-claude/multilingual-support)
 * [Token counting](/en/docs/build-with-claude/token-counting)
 * [Embeddings](/en/docs/build-with-claude/embeddings)
 * [Vision](/en/docs/build-with-claude/vision)
 * [PDF support](/en/docs/build-with-claude/pdf-support)
 * [Files API](/en/docs/build-with-claude/files)
 * [Search results](/en/docs/build-with-claude/search-results)
 * [Google Sheets add-on](/en/docs/agents-and-tools/claude-for-sheets)
##### Tools
 * [Overview](/en/docs/agents-and-tools/tool-use/overview)
 * [How to implement tool use](/en/docs/agents-and-tools/tool-use/implement-tool-use)
 * [Token-efficient tool use](/en/docs/agents-and-tools/tool-use/token-efficient-tool-use)
 * [Fine-grained tool streaming](/en/docs/agents-and-tools/tool-use/fine-grained-tool-streaming)
 * [Bash tool](/en/docs/agents-and-tools/tool-use/bash-tool)
 * [Code execution tool](/en/docs/agents-and-tools/tool-use/code-execution-tool)
 * [Computer use tool](/en/docs/agents-and-tools/tool-use/computer-use-tool)
 * [Text editor tool](/en/docs/agents-and-tools/tool-use/text-editor-tool)
 * [Web fetch tool](/en/docs/agents-and-tools/tool-use/web-fetch-tool)
 * [Web search tool](/en/docs/agents-and-tools/tool-use/web-search-tool)
 * [Memory tool](/en/docs/agents-and-tools/tool-use/memory-tool)
##### Agent Skills
 * [Overview](/en/docs/agents-and-tools/agent-skills/overview)
 * [Quickstart](/en/docs/agents-and-tools/agent-skills/quickstart)
 * [Best practices](/en/docs/agents-and-tools/agent-skills/best-practices)
##### Model Context Protocol (MCP)
 * [MCP connector](/en/docs/agents-and-tools/mcp-connector)
 * [Remote MCP servers](/en/docs/agents-and-tools/remote-mcp-servers)
##### Use cases
 * [Overview](/en/docs/about-claude/use-case-guides/overview)
 * [Ticket routing](/en/docs/about-claude/use-case-guides/ticket-routing)
 * [Customer support agent](/en/docs/about-claude/use-case-guides/customer-support-chat)
 * [Content moderation](/en/docs/about-claude/use-case-guides/content-moderation)
 * [Legal summarization](/en/docs/about-claude/use-case-guides/legal-summarization)
##### Prompt engineering
 * [Overview](/en/docs/build-with-claude/prompt-engineering/overview)
 * [Claude 4 best practices](/en/docs/build-with-claude/prompt-engineering/claude-4-best-practices)
 * [Prompt generator](/en/docs/build-with-claude/prompt-engineering/prompt-generator)
 * [Use prompt templates](/en/docs/build-with-claude/prompt-engineering/prompt-templates-and-variables)
 * [Prompt improver](/en/docs/build-with-claude/prompt-engineering/prompt-improver)
 * [Be clear and direct](/en/docs/build-with-claude/prompt-engineering/be-clear-and-direct)
 * [Use examples (multishot prompting)](/en/docs/build-with-claude/prompt-engineering/multishot-prompting)
 * [Let Claude think (CoT)](/en/docs/build-with-claude/prompt-engineering/chain-of-thought)
 * [Use XML tags](/en/docs/build-with-claude/prompt-engineering/use-xml-tags)
 * [Give Claude a role (system prompts)](/en/docs/build-with-claude/prompt-engineering/system-prompts)
 * [Prefill Claude's response](/en/docs/build-with-claude/prompt-engineering/prefill-claudes-response)
 * [Chain complex prompts](/en/docs/build-with-claude/prompt-engineering/chain-prompts)
 * [Long context tips](/en/docs/build-with-claude/prompt-engineering/long-context-tips)
 * [Extended thinking tips](/en/docs/build-with-claude/prompt-engineering/extended-thinking-tips)
##### Test & evaluate
 * [Define success criteria](/en/docs/test-and-evaluate/define-success)
 * [Develop test cases](/en/docs/test-and-evaluate/develop-tests)
 * [Using the Evaluation Tool](/en/docs/test-and-evaluate/eval-tool)
 * [Reducing latency](/en/docs/test-and-evaluate/strengthen-guardrails/reduce-latency)
##### Strengthen guardrails
 * [Reduce hallucinations](/en/docs/test-and-evaluate/strengthen-guardrails/reduce-hallucinations)
 * [Increase output consistency](/en/docs/test-and-evaluate/strengthen-guardrails/increase-consistency)
 * [Mitigate jailbreaks](/en/docs/test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks)
 * [Streaming refusals](/en/docs/test-and-evaluate/strengthen-guardrails/handle-streaming-refusals)
 * [Reduce prompt leak](/en/docs/test-and-evaluate/strengthen-guardrails/reduce-prompt-leak)
 * [Keep Claude in character](/en/docs/test-and-evaluate/strengthen-guardrails/keep-claude-in-character)
On this page
 * [Use cases](#use-cases)
 * [How it works](#how-it-works)
 * [Example: How memory tool calls work](#example%3A-how-memory-tool-calls-work)
 * [Supported models](#supported-models)
 * [Getting started](#getting-started)
 * [Basic usage](#basic-usage)
 * [Tool commands](#tool-commands)
 * [view](#view)
 * [create](#create)
 * [str_replace](#str-replace)
 * [insert](#insert)
 * [delete](#delete)
 * [rename](#rename)
 * [Prompting guidance](#prompting-guidance)
 * [Security considerations](#security-considerations)
 * [Sensitive information](#sensitive-information)
 * [File storage size](#file-storage-size)
 * [Memory expiration](#memory-expiration)
 * [Path traversal protection](#path-traversal-protection)
 * [Error handling](#error-handling)
 * [Using with Context Editing](#using-with-context-editing)
 * [How they work together](#how-they-work-together)
 * [Example workflow](#example-workflow)
 * [Configuration](#configuration)
The memory tool enables Claude to store and retrieve information across conversations through a memory file directory. Claude can create, read, update, and delete files that persist between sessions, allowing it to build knowledge over time without keeping everything in the context window. The memory tool operates client-side—you control where and how the data is stored through your own infrastructure.
The memory tool is currently in beta. To enable it, use the beta header `context-management-2025-06-27` in your API requests.Please reach out through our [feedback form](https://forms.gle/YXC2EKGMhjN1c4L88) to share your feedback on this feature.
## 
[​](#use-cases)
Use cases
 * Maintain project context across multiple agent executions
 * Learn from past interactions, decisions, and feedback
 * Build knowledge bases over time
 * Enable cross-conversation learning where Claude improves at recurring workflows
## 
[​](#how-it-works)
How it works
When enabled, Claude automatically checks its memory directory before starting tasks. Claude can create, read, update, and delete files in the `/memories` directory to store what it learns while working, then reference those memories in future conversations to handle similar tasks more effectively or pick up where it left off. Since this is a client-side tool, Claude makes tool calls to perform memory operations, and your application executes those operations locally. This gives you complete control over where and how the memory is stored. For security, you should restrict all memory operations to the `/memories` directory.
### 
[​](#example%3A-how-memory-tool-calls-work)
Example: How memory tool calls work
When you ask Claude to help with a task, Claude automatically checks its memory directory first. Here’s what a typical interaction looks like: **1. User request:**
Copy
```
"Help me respond to this customer service ticket."
```
**2. Claude checks the memory directory:**
Copy
```
"I'll help you respond to the customer service ticket. Let me check my memory for any previous context."
```
Claude calls the memory tool:
Copy
```
{
 "type": "tool_use",
 "id": "toolu_01C4D5E6F7G8H9I0J1K2L3M4",
 "name": "memory",
 "input": {
 "command": "view",
 "path": "/memories"
 }
}
```
**3. Your application returns the directory contents:**
Copy
```
{
 "type": "tool_result",
 "tool_use_id": "toolu_01C4D5E6F7G8H9I0J1K2L3M4",
 "content": "Directory: /memories\n- customer_service_guidelines.xml\n- refund_policies.xml"
}
```
**4. Claude reads relevant files:**
Copy
```
{
 "type": "tool_use",
 "id": "toolu_01D5E6F7G8H9I0J1K2L3M4N5",
 "name": "memory",
 "input": {
 "command": "view",
 "path": "/memories/customer_service_guidelines.xml"
 }
}
```
**5. Your application returns the file contents:**
Copy
```
{
 "type": "tool_result",
 "tool_use_id": "toolu_01D5E6F7G8H9I0J1K2L3M4N5",
 "content": "<guidelines>\n<addressing_customers>\n- Always address customers by their first name\n- Use empathetic language\n..."
}
```
**6. Claude uses the memory to help:**
Copy
```
"Based on your customer service guidelines, I can help you craft a response. Please share the ticket details..."
```
## 
[​](#supported-models)
Supported models
The memory tool is available on:
 * Claude Sonnet 4.5 (`claude-sonnet-4-5-20250929`)
 * Claude Sonnet 4 (`claude-sonnet-4-20250514`)
 * Claude Haiku 4.5 (`claude-haiku-4-5-20251001`)
 * Claude Opus 4.1 (`claude-opus-4-1-20250805`)
 * Claude Opus 4 (`claude-opus-4-20250514`)
## 
[​](#getting-started)
Getting started
To use the memory tool:
 1. Include the beta header `context-management-2025-06-27` in your API requests
 2. Add the memory tool to your request
 3. Implement client-side handlers for memory operations
To handle memory tool operations in your application, you need to implement handlers for each memory command. Our SDKs provide memory tool helpers that handle the tool interface—you can subclass `BetaAbstractMemoryTool` (Python) or use `betaMemoryTool` (TypeScript) to implement your own memory backend (file-based, database, cloud storage, encrypted files, etc.).For working examples, see:
 * Python: [examples/memory/basic.py](https://github.com/anthropics/anthropic-sdk-python/blob/main/examples/memory/basic.py)
 * TypeScript: [examples/tools-helpers-memory.ts](https://github.com/anthropics/anthropic-sdk-typescript/blob/main/examples/tools-helpers-memory.ts)
## 
[​](#basic-usage)
Basic usage
cURL
Python
TypeScript
Copy
```
curl https://api.anthropic.com/v1/messages \
 --header "x-api-key: $ANTHROPIC_API_KEY" \
 --header "anthropic-version: 2023-06-01" \
 --header "content-type: application/json" \
 --header "anthropic-beta: context-management-2025-06-27" \
 --data '{
 "model": "claude-sonnet-4-5",
 "max_tokens": 2048,
 "messages": [
 {
 "role": "user",
 "content": "I'\''m working on a Python web scraper that keeps crashing with a timeout error. Here'\''s the problematic function:\n\n```python\ndef fetch_page(url, retries=3):\n for i in range(retries):\n try:\n response = requests.get(url, timeout=5)\n return response.text\n except requests.exceptions.Timeout:\n if i == retries - 1:\n raise\n time.sleep(1)\n```\n\nPlease help me debug this."
 }
 ],
 "tools": [{
 "type": "memory_20250818",
 "name": "memory"
 }]
 }'
```
## 
[​](#tool-commands)
Tool commands
Your client-side implementation needs to handle these memory tool commands:
### 
[​](#view)
view
Shows directory contents or file contents with optional line ranges:
Copy
```
{
 "command": "view",
 "path": "/memories",
 "view_range": [1, 10] // Optional: view specific lines
}
```
### 
[​](#create)
create
Create or overwrite a file:
Copy
```
{
 "command": "create",
 "path": "/memories/notes.txt",
 "file_text": "Meeting notes:\n- Discussed project timeline\n- Next steps defined\n"
}
```
### 
[​](#str-replace)
str_replace
Replace text in a file:
Copy
```
{
 "command": "str_replace",
 "path": "/memories/preferences.txt",
 "old_str": "Favorite color: blue",
 "new_str": "Favorite color: green"
}
```
### 
[​](#insert)
insert
Insert text at a specific line:
Copy
```
{
 "command": "insert",
 "path": "/memories/todo.txt",
 "insert_line": 2,
 "insert_text": "- Review memory tool documentation\n"
}
```
### 
[​](#delete)
delete
Delete a file or directory:
Copy
```
{
 "command": "delete",
 "path": "/memories/old_file.txt"
}
```
### 
[​](#rename)
rename
Rename or move a file/directory:
Copy
```
{
 "command": "rename",
 "old_path": "/memories/draft.txt",
 "new_path": "/memories/final.txt"
}
```
## 
[​](#prompting-guidance)
Prompting guidance
We automatically include this instruction to the system prompt when the memory tool is included:
Copy
```
IMPORTANT: ALWAYS VIEW YOUR MEMORY DIRECTORY BEFORE DOING ANYTHING ELSE.
MEMORY PROTOCOL:
1. Use the `view` command of your `memory` tool to check for earlier progress.
2. ... (work on the task) ...
 - As you make progress, record status / progress / thoughts etc in your memory.
ASSUME INTERRUPTION: Your context window might be reset at any moment, so you risk losing any progress that is not recorded in your memory directory.
```
If you observe Claude creating cluttered memory files, you can include this instruction:
> Note: when editing your memory folder, always try to keep its content up-to-date, coherent and organized. You can rename or delete files that are no longer relevant. Do not create new files unless necessary.
You can also guide what Claude writes to memory, e.g., “Only write down information relevant to <topic> in your memory system.”
## 
[​](#security-considerations)
Security considerations
Here are important security concerns when implementing your memory store:
### 
[​](#sensitive-information)
Sensitive information
Claude will usually refuse to write down sensitive information in memory files. However, you may want to implement stricter validation that strips out potentially sensitive information.
### 
[​](#file-storage-size)
File storage size
Consider tracking memory file sizes and preventing files from growing too large. Consider adding a maximum number of characters the memory read command can return, and let Claude paginate through contents.
### 
[​](#memory-expiration)
Memory expiration
Consider clearing out memory files periodically that haven’t been accessed in an extended time.
### 
[​](#path-traversal-protection)
Path traversal protection
Malicious path inputs could attempt to access files outside the `/memories` directory. Your implementation **MUST** validate all paths to prevent directory traversal attacks.
Consider these safeguards:
 * Validate that all paths start with `/memories`
 * Resolve paths to their canonical form and verify they remain within the memory directory
 * Reject paths containing sequences like `../`, `..\\`, or other traversal patterns
 * Watch for URL-encoded traversal sequences (`%2e%2e%2f`)
 * Use your language’s built-in path security utilities (e.g., Python’s `pathlib.Path.resolve()` and `relative_to()`)
## 
[​](#error-handling)
Error handling
The memory tool uses the same error handling patterns as the [text editor tool](/en/docs/agents-and-tools/tool-use/text-editor-tool#handle-errors). Common errors include file not found, permission errors, and invalid paths.
## 
[​](#using-with-context-editing)
Using with Context Editing
The memory tool can be combined with [context editing](/en/docs/build-with-claude/context-editing), which automatically clears old tool results when conversation context grows beyond a configured threshold. This combination enables long-running agentic workflows that would otherwise exceed context limits.
### 
[​](#how-they-work-together)
How they work together
When context editing is enabled and your conversation approaches the clearing threshold, Claude automatically receives a warning notification. This prompts Claude to preserve any important information from tool results into memory files before those results are cleared from the context window. After tool results are cleared, Claude can retrieve the stored information from memory files whenever needed, effectively treating memory as an extension of its working context. This allows Claude to:
 * Continue complex, multi-step workflows without losing critical information
 * Reference past work and decisions even after tool results are removed
 * Maintain coherent context across conversations that would exceed typical context limits
 * Build up a knowledge base over time while keeping the active context window manageable
### 
[​](#example-workflow)
Example workflow
Consider a code refactoring project with many file operations:
 1. Claude makes numerous edits to files, generating many tool results
 2. As the context grows and approaches your threshold, Claude receives a warning
 3. Claude summarizes the changes made so far to a memory file (e.g., `/memories/refactoring_progress.xml`)
 4. Context editing clears the older tool results automatically
 5. Claude continues working, referencing the memory file when it needs to recall what changes were already completed
 6. The workflow can continue indefinitely, with Claude managing both active context and persistent memory
### 
[​](#configuration)
Configuration
To use both features together:
Python
TypeScript
Copy
```
response = client.beta.messages.create(
 model="claude-sonnet-4-5",
 max_tokens=4096,
 messages=[...],
 tools=[
 {
 "type": "memory_20250818",
 "name": "memory"
 },
 # Your other tools
 ],
 betas=["context-management-2025-06-27"],
 context_management={
 "edits": [
 {
 "type": "clear_tool_uses_20250919",
 "trigger": {
 "type": "input_tokens",
 "value": 100000
 },
 "keep": {
 "type": "tool_uses",
 "value": 3
 }
 }
 ]
 }
)
```
You can also exclude memory tool calls from being cleared to ensure Claude always has access to recent memory operations:
Python
TypeScript
Copy
```
context_management={
 "edits": [
 {
 "type": "clear_tool_uses_20250919",
 "exclude_tools": ["memory"]
 }
 ]
}
```
Was this page helpful?
YesNo
[Web search tool](/en/docs/agents-and-tools/tool-use/web-search-tool)[Overview](/en/docs/agents-and-tools/agent-skills/overview)
Assistant
Responses are generated using AI and may contain mistakes.